== Analyzed Logical Plan ==
year: string, postcode: string, suburb: string, emission_source: string, total_electricity: string, total_gas: string, intensity_per_annum_kwh_per_customer: string, intensity_per_annum_gj_per_customer: string, intensity_per_day_kwh_per_customer: string, intensity_per_day_gj_per_customer: string, scope_1: string, scope_2: string, scope_3: string, total_emissions: string, avg_emissions_per_customer: string, avg_emissions_per_customer_per_day: string, total_cost: string, avg_cost_intensity_per_day: string, avg_cost_intensity_per_month: string, avg_cost_intensity_per_annum: string, no_of_individuals_income_tax: string, avg_salary: string, median_salary: string, avg_net_rent: string
Project [year#19290, postcode#19291, suburb#19292, emission_source#19293, total_electricity#19294, total_gas#19295, intensity_per_annum_kwh_per_customer#19296, intensity_per_annum_gj_per_customer#19297, intensity_per_day_kwh_per_customer#19298, intensity_per_day_gj_per_customer#19299, scope_1#19300, scope_2#19301, scope_3#19302, total_emissions#19303, avg_emissions_per_customer#19304, avg_emissions_per_customer_per_day#19305, total_cost#19306, avg_cost_intensity_per_day#19307, avg_cost_intensity_per_month#19308, avg_cost_intensity_per_annum#19309, no_of_individuals_income_tax#19310, avg_salary#19311, median_salary#19312, avg_net_rent#19313]
+- PipelineRelationNode `harshal_donotdelete`.`pipeline1`
   +- SubqueryAlias pipeline1
      +- Project [harshalshah_donotdelete_casey_Year#19233 AS year#19290, harshalshah_donotdelete_casey_Postcode#19234 AS postcode#19291, harshalshah_donotdelete_casey_Suburb#19235 AS suburb#19292, harshalshah_donotdelete_casey_Emission source#19236 AS emission_source#19293, harshalshah_donotdelete_casey_Total Electricity (KWh)#19237 AS total_electricity#19294, harshalshah_donotdelete_casey_Total Gas (GJ)#19238 AS total_gas#19295, harshalshah_donotdelete_casey_Average Intensity (KWh/per customer) per annum#19239 AS intensity_per_annum_kwh_per_customer#19296, harshalshah_donotdelete_casey_Average Intensity (GJ/per customer)  per annum#19240 AS intensity_per_annum_gj_per_customer#19297, harshalshah_donotdelete_casey_Average Intensity (KWh/per customer) per day#19241 AS intensity_per_day_kwh_per_customer#19298, harshalshah_donotdelete_casey_Average Intensity (MJ/per customer)  per day#19242 AS intensity_per_day_gj_per_customer#19299, harshalshah_donotdelete_casey_Scope 1  (KG CO2e)#19243 AS scope_1#19300, harshalshah_donotdelete_casey_Scope 2  (KG CO2e)#19244 AS scope_2#19301, harshalshah_donotdelete_casey_Scope 3  (KG CO2e)#19245 AS scope_3#19302, harshalshah_donotdelete_casey_Total Emissions (KG CO2e)#19246 AS total_emissions#19303, harshalshah_donotdelete_casey_Average Emissions per customer (KG CO2e)#19247 AS avg_emissions_per_customer#19304, harshalshah_donotdelete_casey_Average Emissions Energy  per customer (KG CO2e) per day#19248 AS avg_emissions_per_customer_per_day#19305, harshalshah_donotdelete_casey_Total Cost ($)#19252 AS total_cost#19306, harshalshah_donotdelete_casey_Average Intensity ($/Household)  per day#19253 AS avg_cost_intensity_per_day#19307, harshalshah_donotdelete_casey_Average Intensity ($/Household)  per Month#19254 AS avg_cost_intensity_per_month#19308, harshalshah_donotdelete_casey_Average Intensity ($/Household)  per annum#19255 AS avg_cost_intensity_per_annum#19309, harshalshah_donotdelete_income_Number of individuals lodging an income tax return#19257 AS no_of_individuals_income_tax#19310, harshalshah_donotdelete_income_Average salary or wages#19263 AS avg_salary#19311, harshalshah_donotdelete_income_Median salary or wages#19264 AS median_salary#19312, harshalshah_donotdelete_income_Average net rent#19267 AS avg_net_rent#19313]
         +- Project [Year#19176 AS harshalshah_donotdelete_casey_Year#19233, Postcode#19177 AS harshalshah_donotdelete_casey_Postcode#19234, Suburb#19178 AS harshalshah_donotdelete_casey_Suburb#19235, Emission source#19179 AS harshalshah_donotdelete_casey_Emission source#19236, Total Electricity (KWh)#19180 AS harshalshah_donotdelete_casey_Total Electricity (KWh)#19237, Total Gas (GJ)#19181 AS harshalshah_donotdelete_casey_Total Gas (GJ)#19238, Average Intensity (KWh/per customer) per annum#19182 AS harshalshah_donotdelete_casey_Average Intensity (KWh/per customer) per annum#19239, Average Intensity (GJ/per customer)  per annum#19183 AS harshalshah_donotdelete_casey_Average Intensity (GJ/per customer)  per annum#19240, Average Intensity (KWh/per customer) per day#19184 AS harshalshah_donotdelete_casey_Average Intensity (KWh/per customer) per day#19241, Average Intensity (MJ/per customer)  per day#19185 AS harshalshah_donotdelete_casey_Average Intensity (MJ/per customer)  per day#19242, Scope 1  (KG CO2e)#19186 AS harshalshah_donotdelete_casey_Scope 1  (KG CO2e)#19243, Scope 2  (KG CO2e)#19187 AS harshalshah_donotdelete_casey_Scope 2  (KG CO2e)#19244, Scope 3  (KG CO2e)#19188 AS harshalshah_donotdelete_casey_Scope 3  (KG CO2e)#19245, Total Emissions (KG CO2e)#19189 AS harshalshah_donotdelete_casey_Total Emissions (KG CO2e)#19246, Average Emissions per customer (KG CO2e)#19190 AS harshalshah_donotdelete_casey_Average Emissions per customer (KG CO2e)#19247, Average Emissions Energy  per customer (KG CO2e) per day#19191 AS harshalshah_donotdelete_casey_Average Emissions Energy  per customer (KG CO2e) per day#19248, Rest of municipality Total Electricity (kWh)#19192 AS harshalshah_donotdelete_casey_Rest of municipality Total Electricity (kWh)#19249, Rest of municipality Total Gas (GJ)#19193 AS harshalshah_donotdelete_casey_Rest of municipality Total Gas (GJ)#19250, Rest of municipality Emissions (KG CO2e)#19194 AS harshalshah_donotdelete_casey_Rest of municipality Emissions (KG CO2e)#19251, Total Cost ($)#19195 AS harshalshah_donotdelete_casey_Total Cost ($)#19252, Average Intensity ($/Household)  per day#19196 AS harshalshah_donotdelete_casey_Average Intensity ($/Household)  per day#19253, Average Intensity ($/Household)  per Month#19197 AS harshalshah_donotdelete_casey_Average Intensity ($/Household)  per Month#19254, Average Intensity ($/Household)  per annum#19198 AS harshalshah_donotdelete_casey_Average Intensity ($/Household)  per annum#19255, Postcode#19199 AS harshalshah_donotdelete_income_Postcode#19256, ... 33 more fields]
            +- Join Inner, (Postcode#19177 = Postcode#19199)
               :- Project [Year#19176, Postcode#19177, Suburb#19178, Emission source#19179, Total Electricity (KWh)#19180, Total Gas (GJ)#19181, Average Intensity (KWh/per customer) per annum#19182, Average Intensity (GJ/per customer)  per annum#19183, Average Intensity (KWh/per customer) per day#19184, Average Intensity (MJ/per customer)  per day#19185, Scope 1  (KG CO2e)#19186, Scope 2  (KG CO2e)#19187, Scope 3  (KG CO2e)#19188, Total Emissions (KG CO2e)#19189, Average Emissions per customer (KG CO2e)#19190, Average Emissions Energy  per customer (KG CO2e) per day#19191, Rest of municipality Total Electricity (kWh)#19192, Rest of municipality Total Gas (GJ)#19193, Rest of municipality Emissions (KG CO2e)#19194, Total Cost ($)#19195, Average Intensity ($/Household)  per day#19196, Average Intensity ($/Household)  per Month#19197, Average Intensity ($/Household)  per annum#19198]
               :  +- IgnoreChildPrivilegesSingleWrapper
               :     +- SubqueryAlias casey
               :        +- LightningLogicalRelation[Year#19176,Postcode#19177,Suburb#19178,Emission source#19179,Total Electricity (KWh)#19180,Total Gas (GJ)#19181,Average Intensity (KWh/per customer) per annum#19182,Average Intensity (GJ/per customer)  per annum#19183,Average Intensity (KWh/per customer) per day#19184,Average Intensity (MJ/per customer)  per day#19185,Scope 1  (KG CO2e)#19186,Scope 2  (KG CO2e)#19187,Scope 3  (KG CO2e)#19188,Total Emissions (KG CO2e)#19189,Average Emissions per customer (KG CO2e)#19190,Average Emissions Energy  per customer (KG CO2e) per day#19191,Rest of municipality Total Electricity (kWh)#19192,Rest of municipality Total Gas (GJ)#19193,Rest of municipality Emissions (KG CO2e)#19194,Total Cost ($)#19195,Average Intensity ($/Household)  per day#19196,Average Intensity ($/Household)  per Month#19197,Average Intensity ($/Household)  per annum#19198] csv
               +- Project [Postcode#19199, Number of individuals lodging an income tax return#19200, Count taxable income or loss#19201, Average taxable income or loss#19202, Median taxable income or loss#19203, Proportion with salary or wages#19204, Count salary or wages#19205, Average salary or wages#19206, Median salary or wages#19207, Proportion with net rent#19208, Count net rent#19209, Average net rent#19210, Median net rent#19211, Count total income or loss#19212, Average total income or loss#19213, Median total income or loss#19214, Count total deductions#19215, Average total deductions#19216, Median total deductions#19217, Proportion with total business income#19218, Count total business income#19219, Average total business income#19220, Median total business income#19221, Proportion with total business expenses#19222, ... 10 more fields]
                  +- IgnoreChildPrivilegesSingleWrapper
                     +- SubqueryAlias income
                        +- LightningLogicalRelation[Postcode#19199,Number of individuals lodging an income tax return#19200,Count taxable income or loss#19201,Average taxable income or loss#19202,Median taxable income or loss#19203,Proportion with salary or wages#19204,Count salary or wages#19205,Average salary or wages#19206,Median salary or wages#19207,Proportion with net rent#19208,Count net rent#19209,Average net rent#19210,Median net rent#19211,Count total income or loss#19212,Average total income or loss#19213,Median total income or loss#19214,Count total deductions#19215,Average total deductions#19216,Median total deductions#19217,Proportion with total business income#19218,Count total business income#19219,Average total business income#19220,Median total business income#19221,Proportion with total business expenses#19222,Count total business expenses#19223,Average total business expenses#19224,Median total business expenses#19225,Proportion with net tax#19226,Count net tax#19227,Average net tax#19228,Median net tax#19229,Count super total accounts balance#19230,Average super total accounts balance#19231,Median super total accounts balance#19232] csv

== Optimized Logical Plan ==
Project [Year#19176 AS year#19290, Postcode#19177 AS postcode#19291, Suburb#19178 AS suburb#19292, Emission source#19179 AS emission_source#19293, Total Electricity (KWh)#19180 AS total_electricity#19294, Total Gas (GJ)#19181 AS total_gas#19295, Average Intensity (KWh/per customer) per annum#19182 AS intensity_per_annum_kwh_per_customer#19296, Average Intensity (GJ/per customer)  per annum#19183 AS intensity_per_annum_gj_per_customer#19297, Average Intensity (KWh/per customer) per day#19184 AS intensity_per_day_kwh_per_customer#19298, Average Intensity (MJ/per customer)  per day#19185 AS intensity_per_day_gj_per_customer#19299, Scope 1  (KG CO2e)#19186 AS scope_1#19300, Scope 2  (KG CO2e)#19187 AS scope_2#19301, Scope 3  (KG CO2e)#19188 AS scope_3#19302, Total Emissions (KG CO2e)#19189 AS total_emissions#19303, Average Emissions per customer (KG CO2e)#19190 AS avg_emissions_per_customer#19304, Average Emissions Energy  per customer (KG CO2e) per day#19191 AS avg_emissions_per_customer_per_day#19305, Total Cost ($)#19195 AS total_cost#19306, Average Intensity ($/Household)  per day#19196 AS avg_cost_intensity_per_day#19307, Average Intensity ($/Household)  per Month#19197 AS avg_cost_intensity_per_month#19308, Average Intensity ($/Household)  per annum#19198 AS avg_cost_intensity_per_annum#19309, Number of individuals lodging an income tax return#19200 AS no_of_individuals_income_tax#19310, Average salary or wages#19206 AS avg_salary#19311, Median salary or wages#19207 AS median_salary#19312, Average net rent#19210 AS avg_net_rent#19313]
+- Join Inner, (Postcode#19177 = Postcode#19199)
   :- Project [Year#19176, Postcode#19177, Suburb#19178, Emission source#19179, Total Electricity (KWh)#19180, Total Gas (GJ)#19181, Average Intensity (KWh/per customer) per annum#19182, Average Intensity (GJ/per customer)  per annum#19183, Average Intensity (KWh/per customer) per day#19184, Average Intensity (MJ/per customer)  per day#19185, Scope 1  (KG CO2e)#19186, Scope 2  (KG CO2e)#19187, Scope 3  (KG CO2e)#19188, Total Emissions (KG CO2e)#19189, Average Emissions per customer (KG CO2e)#19190, Average Emissions Energy  per customer (KG CO2e) per day#19191, Total Cost ($)#19195, Average Intensity ($/Household)  per day#19196, Average Intensity ($/Household)  per Month#19197, Average Intensity ($/Household)  per annum#19198]
   :  +- Filter isnotnull(Postcode#19177)
   :     +- LightningLogicalRelation[Year#19176,Postcode#19177,Suburb#19178,Emission source#19179,Total Electricity (KWh)#19180,Total Gas (GJ)#19181,Average Intensity (KWh/per customer) per annum#19182,Average Intensity (GJ/per customer)  per annum#19183,Average Intensity (KWh/per customer) per day#19184,Average Intensity (MJ/per customer)  per day#19185,Scope 1  (KG CO2e)#19186,Scope 2  (KG CO2e)#19187,Scope 3  (KG CO2e)#19188,Total Emissions (KG CO2e)#19189,Average Emissions per customer (KG CO2e)#19190,Average Emissions Energy  per customer (KG CO2e) per day#19191,Rest of municipality Total Electricity (kWh)#19192,Rest of municipality Total Gas (GJ)#19193,Rest of municipality Emissions (KG CO2e)#19194,Total Cost ($)#19195,Average Intensity ($/Household)  per day#19196,Average Intensity ($/Household)  per Month#19197,Average Intensity ($/Household)  per annum#19198] csv
   +- Project [Postcode#19199, Number of individuals lodging an income tax return#19200, Average salary or wages#19206, Median salary or wages#19207, Average net rent#19210]
      +- Filter isnotnull(Postcode#19199)
         +- LightningLogicalRelation[Postcode#19199,Number of individuals lodging an income tax return#19200,Count taxable income or loss#19201,Average taxable income or loss#19202,Median taxable income or loss#19203,Proportion with salary or wages#19204,Count salary or wages#19205,Average salary or wages#19206,Median salary or wages#19207,Proportion with net rent#19208,Count net rent#19209,Average net rent#19210,Median net rent#19211,Count total income or loss#19212,Average total income or loss#19213,Median total income or loss#19214,Count total deductions#19215,Average total deductions#19216,Median total deductions#19217,Proportion with total business income#19218,Count total business income#19219,Average total business income#19220,Median total business income#19221,Proportion with total business expenses#19222,Count total business expenses#19223,Average total business expenses#19224,Median total business expenses#19225,Proportion with net tax#19226,Count net tax#19227,Average net tax#19228,Median net tax#19229,Count super total accounts balance#19230,Average super total accounts balance#19231,Median super total accounts balance#19232] csv

== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- Project [Year#19176 AS year#19290, Postcode#19177 AS postcode#19291, Suburb#19178 AS suburb#19292, Emission source#19179 AS emission_source#19293, Total Electricity (KWh)#19180 AS total_electricity#19294, Total Gas (GJ)#19181 AS total_gas#19295, Average Intensity (KWh/per customer) per annum#19182 AS intensity_per_annum_kwh_per_customer#19296, Average Intensity (GJ/per customer)  per annum#19183 AS intensity_per_annum_gj_per_customer#19297, Average Intensity (KWh/per customer) per day#19184 AS intensity_per_day_kwh_per_customer#19298, Average Intensity (MJ/per customer)  per day#19185 AS intensity_per_day_gj_per_customer#19299, Scope 1  (KG CO2e)#19186 AS scope_1#19300, Scope 2  (KG CO2e)#19187 AS scope_2#19301, Scope 3  (KG CO2e)#19188 AS scope_3#19302, Total Emissions (KG CO2e)#19189 AS total_emissions#19303, Average Emissions per customer (KG CO2e)#19190 AS avg_emissions_per_customer#19304, Average Emissions Energy  per customer (KG CO2e) per day#19191 AS avg_emissions_per_customer_per_day#19305, Total Cost ($)#19195 AS total_cost#19306, Average Intensity ($/Household)  per day#19196 AS avg_cost_intensity_per_day#19307, Average Intensity ($/Household)  per Month#19197 AS avg_cost_intensity_per_month#19308, Average Intensity ($/Household)  per annum#19198 AS avg_cost_intensity_per_annum#19309, Number of individuals lodging an income tax return#19200 AS no_of_individuals_income_tax#19310, Average salary or wages#19206 AS avg_salary#19311, Median salary or wages#19207 AS median_salary#19312, Average net rent#19210 AS avg_net_rent#19313]
   +- BroadcastHashJoin [Postcode#19177], [Postcode#19199], Inner, BuildLeft, false
      :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, string, false]),false), [plan_id=4124]
      :  +- Filter isnotnull(Postcode#19177)
      :     +- FileScan csv HARSHALSHAH_DONOTDELETE.casey[Year#19176,Postcode#19177,Suburb#19178,Emission source#19179,Total Electricity (KWh)#19180,Total Gas (GJ)#19181,Average Intensity (KWh/per customer) per annum#19182,Average Intensity (GJ/per customer)  per annum#19183,Average Intensity (KWh/per customer) per day#19184,Average Intensity (MJ/per customer)  per day#19185,Scope 1  (KG CO2e)#19186,Scope 2  (KG CO2e)#19187,Scope 3  (KG CO2e)#19188,Total Emissions (KG CO2e)#19189,Average Emissions per customer (KG CO2e)#19190,Average Emissions Energy  per customer (KG CO2e) per day#19191,Total Cost ($)#19195,Average Intensity ($/Household)  per day#19196,Average Intensity ($/Household)  per Month#19197,Average Intensity ($/Household)  per annum#19198] Batched: false, DataFilters: [isnotnull(Postcode#19177)], Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/home/zetaris/customer-data/1d0c220d/file-store/Harshal_Shah-DoNo..., PartitionFilters: [], PushedFilters: [IsNotNull(Postcode)], ReadSchema: struct<Year:string,Postcode:string,Suburb:string,Emission source:string,Total Electricity (KWh):s...
      +- Filter isnotnull(Postcode#19199)
         +- FileScan csv HARSHALSHAH_DONOTDELETE.income[Postcode#19199,Number of individuals lodging an income tax return#19200,Average salary or wages#19206,Median salary or wages#19207,Average net rent#19210] Batched: false, DataFilters: [isnotnull(Postcode#19199)], Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/home/zetaris/customer-data/1d0c220d/file-store/Harshal_Shah-DoNo..., PartitionFilters: [], PushedFilters: [IsNotNull(Postcode)], ReadSchema: struct<Postcode:string,Number of individuals lodging an income tax return:string,Average salary o...
